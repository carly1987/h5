/*!
 * Fancy Countdown v1.3
 *
 * Copyright 2011, Rafael Dery
 *
 * Only for sale at the envato marketplaces
 */

(function(d) {
    d.fancyCountdown = {
        version: "1.3"
    };
    d.fn.fancyCountdown = function(P) {
        function D() {
            // for (var c = document.URL, a = c.indexOf("://") + 3, e = c.indexOf("/", a), c = c.substring(a, e), a = c.lastIndexOf(".") - 1, a = c.lastIndexOf(".", a) + 1, c = c.substring(a, c.length), e = a = 0; e < c.length; ++e) var d = c.charAt(e),
            //     a = a + d.charCodeAt(0);
            // return 991 != a && 1109 != a && "" != c ? !0 : !1
        }

        function Q() {
            O = Date.UTC(a.year, a.month - 1, a.day, a.hour - a.timezone, a.minute, a.second);
            var c = O - (new Date).getTime(),
                h = Math.floor(c / 1E3),
                e = Math.floor(h / 60),
                b = Math.floor(e / 60),
                k = Math.floor(b / 24),
                h = h % 60,
                e = e % 60,
                b = b % 24,
                y = Math.floor(h % 10),
                h = Math.floor(h / 10),
                g = Math.floor(e % 10),
                e = Math.floor(e / 10),
                j = Math.floor(b % 10),
                b = Math.floor(b / 10),
                z = Math.floor(k % 10),
                A = Math.floor(Math.floor(k / 10) % 10),
                k = Math.floor(k / 100);
            if (!B) {
                E = y;
                F = h;
                G = g;
                H = e;
                I = j;
                J = b;
                K = z;
                L = A;
                M = k;
                for (var m = -2, l = 0; 4 > l; ++l) a.digits.seconds && (p && p[l].text(f(y + m, 0, 9)), q && q[l].text(f(h + m, 0, 5))), a.digits.minutes && (r && r[l].text(f(g + m, 0, 9)), s && s[l].text(f(e + m, 0, 5))), a.digits.hours && (t && t[l].text(f(j + m, 0, 9)), u && u[l].text(f(b + m, 0, 2))), a.digits.days && (v && v[l].text(f(z + m, 0, 9)), w && w[l].text(f(A + m, 0, 9)), x && x[l].text(f(k + m, 0, 9))), ++m
            }
            B = !0;
            0 < c ? (E != y && (p && n(p, f(y - 2, 0, 9)), E = y), F != h && q && (n(q, f(h - 2, 0, 5)), F = h), G != g && r && (n(r, f(g - 2, 0, 9)), G = g), H != e && s && (n(s, f(e - 2, 0, 5)), H = e), I != j && t && (n(t, f(j - 2, 0, 9)), I = j), J != b && u && (n(u, f(b - 2, 0, 2)), J = b), K != z && v && (n(v, f(z - 2, 0, 9)), K = z), L != A && w && (n(w, f(A - 2, 0, 9)), L = A), M != k && x && (n(x, f(k - 2, 0, 9)), M = k)) : (d.fancyCountdown.stop(), d.fancyCountdown.reset(), a.callback())
        }

        function n(c, a) {
            var e = c[0].height(),
                f = parseInt(b.children(".fc-digit-offset").css("top")),
                g = parseInt(b.children(".fc-digit-offset").css("bottom"));
            c[0].animate({
                top: -(e - 0) + "px"
            }, 300);
            c[1].animate({
                top: "0px"
            }, 300);
            c[2].animate({
                top: e - 0 + "px"
            }, 300);
            c[3].animate({
                top: e + "px"
            }, 300, function() {
                var b = c.pop();
                d(b).css("top", -d(b).height() + "px");
                b.text(a);
                c.unshift(b)
            })
        }

        function f(c, a, b) {
            return 0 > c ? b + c + 1 : c > b ? a + c - b - 1 : c
        }

        function g() {
            e.children("div:last").append("<div class='fc-digitUnit fc-width fc-height'><ul class='fc-digits'><li>8</li><li>9</li><li>0</li><li>1</li></ul></div>");
            var c = e.children("div:last").children("div:last").find(".fc-digits li").addClass("fc-height fc-font"),
                h = [];
            digitHeight = d(c[0]).height();
            offsetTop = parseInt(e.children(".fc-digit-offset").css("top"));
            offsetBottom = parseInt(e.children(".fc-digit-offset").css("bottom"));
            h[0] = d(c[0]).css("top", -digitHeight);
            h[1] = d(c[1]).css("top", -(digitHeight)*2);
            h[2] = d(c[2]).css("top", "0");
            h[3] = d(c[3]).css("top", digitHeight);
            return h
        }

        function N() {
            // b.children("div:last").append('<div style="background:' + a.fillColor + "; border-color: " + a.borderColor + ';" class="fc-colon fc-height fc-colon-width"><img src="' + a.overlayImageUrl + '" class="fc-digitOverlay" /></div>')
        }

        function C(c, a) {
            var b = a.width();
            a.children(".fc-colon").size() && (b -= a.children(".fc-colon").width() + 4 * parseInt(a.children(".fc-colon").css("marginRight")));
            a.append('<span class="fc-captions">' + c + "</span>")
        }
        var a = d.extend({}, d.fn.fancyCountdown.defaults, P),
            b, j, O, B = !1,
            E, F, G, H, I, J, K, L, M, p, q, r, s, t, u, v, w, x;
        d.fancyCountdown.start = function() {
            j || (B = !1, j = setInterval(Q, 100))
        };
        d.fancyCountdown.stop = function() {
            j && (clearInterval(j), j = null)
        };
        d.fancyCountdown.reset = function() {
            b.find(".fc-digits li").stop(!0, !0);
            for (var a = 0; 4 > a; ++a) p && p[a].text((8 + a) % 10), q && q[a].text((4 + a) % 6), r && r[a].text((8 + a) % 10), s && s[a].text((4 + a) % 6), t && t[a].text((8 + a) % 10), u && u[a].text((1 + a) % 3), v && v[a].text((8 + a) % 10), w && w[a].text((8 + a) % 10), x && x[a].text((8 + a) % 10)
        };
        d.fancyCountdown.fillColor = function(a) {
            b.find(".fc-digitUnit, .fc-colon").css("background", a)
        };
        d.fancyCountdown.targetDate = function(b, f, e, g, k, j) {
            g = g || 0;
            k = k || 0;
            j = j || 0;
            a.year = parseInt(b);
            a.month = parseInt(f);
            a.day = parseInt(e);
            a.hour = parseInt(g);
            a.minute = parseInt(k);
            a.second = parseInt(j);
            B = !1;
            d.fancyCountdown.start()
        };
        d.fancyCountdown.timezone = function(b) {
            a.timezone = parseFloat(b)
        };
        return this.each(function() {
            D() || (b = d(this), 
            b.addClass("fc-panel").append('<div class="fc-digit-offset"></div>'),
            b.append('<div class="wrapper"><div class="fc-wrapper"></div></div>'), 
            e = b.children(".wrapper").children(".fc-wrapper"),
            a.digits.days && (e.append('<div class="fc-days-wrapper"></div>'), 
            2 < a.dayDigitsAmount && (x = g("days")), 
            1 < a.dayDigitsAmount && (w = g("days")), 
            0 < a.dayDigitsAmount && (v = g("days")), 
            a.digits.days && N()), 
            a.digits.hours && (e.append('<div class="fc-hours-wrapper"></div>'), 
            u = g("hours"), t = g("hours"), a.digits.minutes && N()), 
            a.digits.minutes && (e.append('<div class="fc-minutes-wrapper"></div>'), 
            s = g("minutes"), r = g("minutes"), a.digits.seconds && N()), 
            a.digits.seconds && (e.append('<div class="fc-seconds-wrapper"></div>'), 
            q = g("seconds"), p = g("seconds")), 
            a.captions && (parseInt(b.children(".fc-digitUnit").css("margin-right")), 
            a.digits.days && C(a.captionTitles.days, e.children(".fc-days-wrapper")), 
            a.digits.hours && C(a.captionTitles.hours, e.children(".fc-hours-wrapper")), 
            a.digits.minutes && C(a.captionTitles.minutes, e.children(".fc-minutes-wrapper")), 
            a.digits.seconds && C(a.captionTitles.seconds, e.children(".fc-seconds-wrapper"))), 
            D() || (a.autoStart && d.fancyCountdown.start(), d(window).blur(d.fancyCountdown.stop), d(window).focus(d.fancyCountdown.start), D()))
        })
    };
    d.fn.fancyCountdown.defaults = {
        year: 2012,
        month: 12,
        day: 31,
        hour: 0,
        minute: 0,
        second: 0,
        timezone: 0,
        dayDigitsAmount: 2,
        fillColor: "#22292A",
        borderColor: "#d5d5d5",
        autoStart: !0,
        captions: !0,
        digits: {
            days: !0,
            hours: !0,
            minutes: !0,
            seconds: !0
        },
        captionTitles: {
            days: "Days",
            hours: "Hours",
            minutes: "Minutes",
            seconds: "Seconds"
        },
        callback: function() {},
        overlayImageUrl: "images/fancyCountdown/overlay.png"
    }
})(jQuery);